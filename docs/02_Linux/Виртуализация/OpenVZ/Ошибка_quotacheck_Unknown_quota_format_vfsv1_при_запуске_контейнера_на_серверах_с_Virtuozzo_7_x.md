---
title: 'Ошибка "quotacheck: Unknown quota format: vfsv1" при запуске контейнера серверах с Virtuozzo 7.x'
authors: 
 - glowingsword
tags:
 - Virtuozzo
date: 2021-01-08
---

# Ошибка "quotacheck: Unknown quota format: vfsv1" при запуске контейнера серверах с Virtuozzo 7.x

Данная ошибка возникает при попытке запуска контейнера с не поддерживаемым на сервере форматом дисковой квоты.

!!! info "Важно!"
    В этой статье в $CTID у меня указано значение проблемного контейнера, это числовое значение, у каждого контейнера на ноде с Virtuozzo CTID - уникальное значение. 
    Вам необходимо указать интересующее вас значение в данной переменной перед началом выполнения описанных ниже действий, или вместо $CTID вручную указать нужный вам CTID.

Объявляем переменную $CTID со значением CTID контейнера, при запуске которого проявилась данная проблема. В моём случае, это, к примеру, 777.

```bash
CTID=777
```

Для исправления проблемы ищем дисковое устройство виртуалки

```bash
vzctl mount $CTID
```

```bash
mount|grep $CTID
```
получаем строку вида

```bash
/dev/ploop70331p1 on /vz/root/777 type ext4 (rw,relatime,stripe=64,data=ordered,balloon_ino=12,jqfmt=vfsv1,usrjquota=aquota.user,grpjquota=aquota.group)
````
где нас интересует устройство /dev/ploop70331p1.

!!! "Минуточку вашего драгоценного внимания!"
    В моём случае устройство, что использовалось для контейнера, имело наименование ploop70331p1. В вашем случае оно будет называться как-то по другому, к примеру, ploop90661p1.
    Вам необходимо будет вместо ploop70331p1 указать актуальное для вашего случая значение.

Объявляем переменную с наименование устройства, для которого необходимо поправить квоту.

```bash
PLOOP_TO_CHECK=/dev/ploop70331p1
```

Удаляем квоту на данном устройстве

```bash
quotaoff $PLOOP_TO_CHECK
```
создаём квоту заново. Благодаря парамтру ==-c==  утилита quotacheck не будет учитывать старый файл квоты при сканировании, и при окончании сканирования перезапишет его.  
В случае отсутствия файла утилита создаст его заново.

```bash
quotacheck -cug $PLOOP_TO_CHECK
```
Включаем квоту для данного диска

```bash
quotaon $PLOOP_TO_CHECK
```

Запускаем контейнер

```bash
vzctl start $CTID
```

Проверяем, что контейнер успешно запущен

```bash
vzlist|grep $CTID
```