---
title: 'Не доступна VPS, при этом в трейсе winmtr, видно что пакеты доходят до хост-ноды, и закольцовываются на следующем хопе'
authors: 
 - glowingsword
tags:
 - KVM
 - Network
date: 2020-04-22
---

# Не доступна VPS, при этом в трейсе winmtr, видно что пакеты доходят до хост-ноды, и закольцовываются на следующем хопе

!!! warning "Внимание"
    Все IP-адреса, MAC-адреса и прочая конкретика из данных для примера были вычищены, и заменены на не существующие значения. Сделано это во избежания каки-либо совпадений. Таки да, автор прекрасно знает, что не бывает IP-адресов вроде 987.654.321.10, поэтому не нужно пытаться ему сообщить об этом.

Предыстория: выясняется, что с IP-адреса вида 987.654.321.10, не доступен определённый VPS-сервер.

Видим в запрошенном трейсе WinMtr что-то вроде

```bash
|------------------------------------------------------------------------------------------|
|                                      WinMTR statistics                                   |
|                       Host              -   %  | Sent | Recv | Best | Avrg | Wrst | Last |
|------------------------------------------------|------|------|------|------|------|------|
|                            192.168.0.1 -    0  |  127 |  127 |    0 |    0 |    0 |    0 |
|         some-strange-host.some.provider -    0 |  127 |  127 |    1 |    2 |   31 |    1 |
|                         123.123.123.123 -    0 |  127 |  127 |    1 |    1 |   18 |    2 |
|            node100-region1.some.cloud -    0   |  127 |  127 |   27 |   27 |   30 |   27 |
|                   No response from host -  100 |   25 |    0 |    0 |    0 |    0 |    0 |
|                   No response from host -  100 |   25 |    0 |    0 |    0 |    0 |    0 |
|                   ещё с 10-ко таких строк с No response from host                        |
|                   No response from host -  100 |   25 |    0 |    0 |    0 |    0 |    0 |
|                   No response from host -  100 |   25 |    0 |    0 |    0 |    0 |    0 |
|________________________________________________|______|______|______|______|______|______|
```

При этом с любого другого хоста VPS-ка доступна.

Заходим на тачку, делаем

``` bash
# ifconfig
ens6      Link encap:Ethernet  HWaddr AA:BB:00:CC:EE:FF
          inet addr:YY.YY.ZZ.ZZ  Bcast:YY.ZZ.YY.ZZ  Mask:255.255.255.0
          inet6 addr: ffff:ffff::0:0::ffe/64 Scope:Global
          inet6 addr: ffff::ffff:ff:ffff:ffff/64 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:87557546 errors:0 dropped:0 overruns:0 frame:0
          TX packets:119107197 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000
          RX bytes:10781821072 (10.7 GB)  TX bytes:132576572584 (132.5 GB)

ens6:0    Link encap:Ethernet  HWaddr AA:BB:00:CC:EE:GG
          inet addr:987.654.321.10  Bcast:987.654.321.255  Mask:255.255.255.255
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
```

Видим 987.654.321.10 среди добавленных на VPS IP. Хотя это IP-адрес клиентского ПК. Этот IP-адрес на VPS присутствовать не должен. 
Собственно, его добавление на VPS и приводит к эффекту, описанному выше, когда трафик с этого IP закольцовывается на VPS-ке...